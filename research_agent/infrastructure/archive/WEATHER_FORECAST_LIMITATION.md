# Weather Forecast Data Limitation - IMPORTANT UPDATE

## Critical Discovery

After testing, we discovered that **historical weather forecast archives are not readily available from Open-Meteo's free API**.

### What We Wanted
- Historical forecasts: What was predicted on 2021-01-01 for 2021-01-15
- Full backfill from 2021 to present
- Training models on historical forecast data

### What's Actually Available
- **Current forecasts only**: What is predicted TODAY for the next 16 days
- Limited historical forecast archives (complex to access)
- Forecast collection should start from deployment date forward for simplicity

## Revised Approach

### Option A: Collect Going Forward (RECOMMENDED FOR PRODUCTION)
**Start collecting forecasts today, build history over time**

Pros:
- ✅ Real forecast data (not synthetic)
- ✅ Proper forecast uncertainty
- ✅ FREE and sustainable
- ✅ Simple, reliable pipeline

Cons:
- ⚠️ Must wait to accumulate training data
- ⚠️ 3-6 months before useful for modeling
- ⚠️ No historical forecast data for backtesting

**Timeline**:
- Today: Start daily forecast collection
- Month 1-3: Accumulate data (not enough for training yet)
- Month 3-6: Minimum viable dataset for initial models
- Month 6+: Robust dataset for production models

### Option B: Synthetic Historical Forecasts (RECOMMENDED FOR IMMEDIATE EXPERIMENTATION)
**Generate artificial forecasts by adding realistic error to historical actuals**

```python
def generate_synthetic_forecast(actual_temp, days_ahead):
    """
    Simulate forecast by adding realistic error based on horizon.

    Typical forecast errors:
    - Day 1: ±1.5°C
    - Day 7: ±2.5°C
    - Day 14: ±3.5°C
    """
    error_std = 1.5 + (days_ahead * 0.15)
    error = np.random.normal(0, error_std)
    return actual_temp + error
```

Pros:
- ✅ Can train models immediately on 2021+ data
- ✅ Realistic forecast error distributions
- ✅ Full historical coverage
- ✅ Good for proof-of-concept

Cons:
- ⚠️ Artificial data (not real forecasts)
- ⚠️ May not capture true forecast biases
- ⚠️ Uncertainty estimates are simulated

### Option C: Wait and See
**Defer weather forecasts entirely until later**

## FINAL DECISION: Hybrid Approach with Documented Data Leakage

**Strategy Approved 2025-11-05:**

Use synthetic forecasts for backfill with **clear documentation of data leakage**, combined with daily collection of real forecasts going forward. This serves as proof-of-concept to determine if weather forecasts provide sufficient improvement to justify purchasing Visual Crossing historical data (~$195).

### Implementation

1. **Deploy daily forecast collector NOW**
   - Lambda function runs daily at 6 AM UTC
   - Collects real 16-day forecasts from Open-Meteo (free)
   - Builds history from 2025-11-06 forward
   - **NO data leakage** in real forecasts

2. **Generate synthetic historical forecasts (2015-2025)**
   - For immediate model experimentation
   - Allows training on full historical window
   - ⚠️ **HAS DATA LEAKAGE** - synthetic forecasts "know" the actual outcome
   - Clearly labeled with `is_synthetic: true` metadata

3. **Evaluate and decide (3-6 months)**
   - If synthetic forecasts show significant SARIMAX improvement → Consider purchasing Visual Crossing
   - Once enough real forecasts accumulated → Retrain on real-only data
   - Compare synthetic vs real performance

### ⚠️ DATA LEAKAGE WARNING

**Synthetic forecasts have inherent data leakage:**

- Generated by: `actual_weather + realistic_random_error`
- The "forecast" knows the actual outcome (just adds noise)
- May overestimate forecast utility compared to real forecasts
- **Models trained on synthetic data MUST document this limitation**

**Why this is acceptable:**
- Serves as proof-of-concept for forecast utility
- Helps justify $195 investment in real historical data
- Real forecasts being collected simultaneously
- Clearly documented in all tables and code

## Updated Data Source Documentation

```yaml
weather_forecasts:
  synthetic_data:
    start_date: 2015-07-07
    end_date: 2025-11-05
    method: historical_actual + realistic_error
    ⚠️ has_data_leakage: TRUE
    quality: approximation
    recommended_use: proof_of_concept_only
    documentation: "Models using this data MUST note data leakage"

  real_data:
    start_date: 2025-11-06  # Deployment date
    end_date: ongoing
    frequency: daily
    horizon: 16 days
    source: Open-Meteo (free)
    ⚠️ has_data_leakage: FALSE
    quality: real_forecast

  limitations:
    - ⚠️ Synthetic data (2015-2025) has DATA LEAKAGE
    - Real data from 2025-11-06 onwards (no leakage)
    - All models MUST document which forecast type used
    - Synthetic results may overestimate forecast utility
    - Transition to real-only or purchase Visual Crossing after evaluation
```

## Next Steps

I'll proceed with the hybrid approach:
1. ✅ Upload region coordinates
2. ⏳ Create synthetic backfill script
3. ⏳ Deploy daily forecast Lambda
4. ⏳ Create Databricks tables
5. ⏳ Integrate into unified_data

Let me know if you'd prefer a different approach!
